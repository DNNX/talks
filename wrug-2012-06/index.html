<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>C-C-C-Combo Maker</title>

  <meta name="viewport" content="width=device-width"/>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <script type="text/javascript" src="./js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>
  <script type="text/javascript" src="./js/coffee-script.js"></script>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" >

  
    <link rel="stylesheet" href="file/wrug-2012-06.css" type="text/css"/>
  

  

  <script type="text/javascript">
  $(function(){
      setupPreso(false, './');
  });
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none"><div class="content" ref="cover/cover">
<h1>C-C-C-Combo Maker</h1>

<h2>Piotr Szotkowski</h2>

<h2><a href="http://chastell.net">chastell.net</a></h2></div>
</div><div class="slide" data-transition="scrollLeft"><div class="content" ref="prime/prime/1">
<pre class="sh_ruby"><code>class Integer
  def sqrt_prime?
    (2..Math.sqrt(self).floor).all? { |i| (self % i).nonzero? }
  end
end

(2..100_000).each &amp;:sqrt_prime?   #=&gt; 1.1 s</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="prime/prime/2">
<pre class="sh_ruby"><code>class Integer
  def skipping_prime?
    return true  if self == 2
    return false if self.even?
    3.step(Math.sqrt(self).floor, 2).all? { |i| (self % i).nonzero? }
  end
end

(2..100_000).each &amp;:skipping_prime?   #=&gt; 0.6 s</code></pre></div>
</div><div class="slide" data-transition="scrollLeft"><div class="content" ref="prime/prime/3">
<pre class="sh_ruby"><code>require 'inline'

class Integer
  inline do |builder|
    builder.include '&lt;math.h&gt;'
    builder.c '
      VALUE inline_prime() {
        long i, number = NUM2LONG(self);
        if (number == 2)     return Qtrue;
        if (number % 2 == 0) return Qfalse;
        for (i = 3; i &lt;= floor(sqrt(number)); i = i + 2) {
          if (number % i == 0) return Qfalse;
        }
        return Qtrue;
      }
    '
  end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="prime/prime/4">
<pre class="sh_ruby"><code>require 'prime'

(2..100_000).each &amp;:prime?</code></pre></div>
</div><div class="slide" data-transition="scrollLeft"><div class="content" ref="prime/prime/5">
<pre class="sh_ruby"><code>require 'benchmark'
require 'inline'
require 'prime'

class Integer
  # &#x2026;
end

range = 2..100_000

Benchmark.bmbm do |bench|
  bench.report('sqrt:')     { range.each &amp;:sqrt_prime?     }
  bench.report('skipping:') { range.each &amp;:skipping_prime? }
  bench.report('inline:')   { range.each &amp;:inline_prime    }
  bench.report('stdlib:')   { range.each &amp;:prime?          }
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline incremental" ref="prime/prime/6">
<pre><code><code class="command">$ ruby bench-prime.rb</code>
<code class="result">Rehearsal ---------------------------------------------
sqrt:       1.150000   0.000000   1.150000 (  1.149098)
skipping:   0.640000   0.000000   0.640000 (  0.645695)
inline:     0.050000   0.000000   0.050000 (  0.048040)
stdlib:     1.850000   0.000000   1.850000 (  1.854002)
------------------------------------ total: 3.690000sec

                user     system      total        real
sqrt:       1.140000   0.000000   1.140000 (  1.135499)
skipping:   0.640000   0.000000   0.640000 (  0.642145)
inline:     0.050000   0.000000   0.050000 (  0.047625)
stdlib:     1.890000   0.000000   1.890000 (  1.885808)
</code></code></pre></div>
</div><div class="slide" data-transition="scrollLeft"><div class="content" ref="popcount/popcount/1">
<h1>popcount</h1>

<h2>ile dana liczba ma jedynek</h2>

<h2>w reprezentacji binarnej</h2></div>
</div><div class="slide" data-transition="scrollLeft"><div class="content" ref="popcount/popcount/2">
<pre class="sh_ruby"><code>class Integer
  def popcount_to_s
    to_s(2).count '1'
  end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="popcount/popcount/3">
<pre class="sh_ruby"><code>require 'inline'

class Integer
  inline do |builder|
    builder.c '
      int popcount_builtin() {
        return __builtin_popcountl(NUM2LONG(self));
      }
    '
  end
end</code></pre></div>
</div><div class="slide" data-transition="scrollLeft"><div class="content" ref="popcount/popcount/4">
<pre class="sh_ruby"><code>require 'benchmark'
require 'inline'

class Integer
  # &#x2026;
end

range = 0...2**22

Benchmark.bmbm do |bench|
  bench.report('to_s:')    { range.each &amp;:popcount_to_s    }
  bench.report('builtin:') { range.each &amp;:popcount_builtin }
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline incremental" ref="popcount/popcount/5">
<pre><code><code class="command">$ ruby bench-popcount.rb</code>
<code class="result">Rehearsal --------------------------------------------
to_s:      5.870000   0.000000   5.870000 (  5.886263)
builtin:   0.520000   0.000000   0.520000 (  0.515771)
----------------------------------- total: 6.390000sec

              user     system      total        real
to_s:      5.860000   0.010000   5.870000 (  5.883422)
builtin:   0.510000   0.010000   0.520000 (  0.520176)
</code></code></pre></div>
</div><div class="slide" data-transition="scrollLeft"><div class="content" ref="hardware/hardware/1">
<pre class="sh_c"><code>#include "nf2util.h"

unsigned get_register(unsigned reg) {
  struct nf2device nf2;
  unsigned val;

  nf2.device_name = "nf2c0";
  check_iface(&amp;nf2);
  openDescriptor(&amp;nf2);

  readReg(&amp;nf2, reg, &amp;val);

  closeDescriptor(&amp;nf2);

  return val;
}</code></pre></div>
</div><div class="slide" data-transition="scrollLeft"><div class="content" ref="hardware/hardware/2">
<pre class="sh_c"><code>#include "nf2util.h"

void set_register(unsigned reg, unsigned val) {
  struct nf2device nf2;

  nf2.device_name = "nf2c0";
  check_iface(&amp;nf2);
  openDescriptor(&amp;nf2);

  writeReg(&amp;nf2, reg, val);

  closeDescriptor(&amp;nf2);
}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="hardware/hardware/3">
<pre class="sh_ruby"><code>require 'ffi'

class NetFPGA::Bridge
  extend FFI::Library
  ffi_lib "regset.so"

  attach_function :get_register, [:uint],        :uint
  attach_function :set_register, [:uint, :uint], :void
end

bridge = NetFPGA::Bridge.new
bridge.get_register 0x2000200               #=&gt; 0xbaadf00d
bridge.set_register 0x2000204, 0xdeadbeef   #=&gt; nil</code></pre></div>
</div><div class="slide" data-transition="scrollLeft"><div class="content bullets" ref="links/links">
<h1>projekty</h1>

<ul>
<li><a href="https://github.com/seattlerb/rubyinline">Ruby Inline</a></li>
<li><a href="https://github.com/luislavena/rake-compiler">rake-compiler</a></li>
<li><a href="https://github.com/ffi/ffi">FFI</a></li>
</ul>
</div>
</div></div>

</body>
</html>
